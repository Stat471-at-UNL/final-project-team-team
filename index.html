<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.548">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>index</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">index</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>sample text</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>        id                           listing_url  scrape_id last_scraped
1 40824219 https://www.airbnb.com/rooms/40824219 2.0251e+13   2025-10-02
2 40833186 https://www.airbnb.com/rooms/40833186 2.0251e+13   2025-10-02
3 40837137 https://www.airbnb.com/rooms/40837137 2.0251e+13   2025-10-02
4 40838018 https://www.airbnb.com/rooms/40838018 2.0251e+13   2025-10-02
5 40839416 https://www.airbnb.com/rooms/40839416 2.0251e+13   2025-10-02
6 40843980 https://www.airbnb.com/rooms/40843980 2.0251e+13   2025-10-01
           source                                             name
1     city scrape       Room close to  Manhattan for FEMALE guests
2 previous scrape      Soho LES East village private room downtown
3 previous scrape         Sunset Park - Quiet and close to subway!
4 previous scrape                 Cozy One Bedroom in Clinton Hill
5     city scrape        ðŸª´XL dojo ðŸŒ¾ shared green yogi palace apt ðŸŒ¿
6     city scrape Cozy 2 Bedroom Spacious Apartment near Manhattan
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          description
1                                                                                                                                                                                                                                                                                                          This cozy spacious room includes a twin size bed, desk and chair for work, night stand and a wardrobe. Shared Bathroom &amp; kitchen. &lt;br /&gt;3 min walking to subway station. &lt;br /&gt;15 minutes to Times Square!
2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
3                                                                                                                                Cozy, lovely bedroom with a comfortable full size bed , modern desk and chair. &lt;br /&gt;You will share the bathroom and kitchen with the other two roommates.&lt;br /&gt;Right in the sunset park of Brooklyn. Only 2 Blocks from the R Trains 45th street station , 20 min to Wall Street and 30min to NYU washington square.&lt;br /&gt;Very close to a small park.&lt;br /&gt;Note: only accept female
4                                                                                                                                                            This sunny one-bedroom apartment is located in the heart of Brooklyn. The neighborhood is filled with gorgeous brownstones and tree-lined streets and is surrounded by wonderful amenities like the post-office and 24-hour laundromat only a block away. Also enjoy bars, cafes, and incredible restaurants just steps away from this amazing location.
5                                                                                                                        New York City living at its best. A massive, cozy, and green penthouse in the heart of the East Village. A spacious two floor-apartment, full of light, plants, and all you need to fully enjoy your stay. Prime location, private access to a shared-1,000 square ft rooftop. Within walking distance of the best bars, restaurants, landmarks and art galleries in the South of Manhattan!
6 This 2 bed. furnished apt on the 2nd fl. in Ozone Park, Queens, provides guests with the experience of real New York. Located in a diverse and friendly neighborhood and is close to the A train Rockaway Blvd station, JFK Airport &amp; bus lines. Many restaurants and shopping retailers close by. The apartment features wood floors, crown molding and recessed lighting. The kitchen is equipped with all you need to prepare meals to enjoy at home.  Multiple windows in rooms prove lots of natural lighting.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            neighborhood_overview
1                                                                                                                                                                                                                                                                                                                                                                                                                                           Sunnyside is a safe residental area. &lt;br /&gt;The apartment is one and half  block away from the 7 train ( 3min walk) and 15 minutes to Manhattan. &lt;br /&gt;The neighborhood is a lovely, quiet area. Restaurants,  bars, local markets and nice shopping centers, banks, pharmacies are all easily accessible and within walking distance.
2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     the sunset park of Brooklyn
4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Clinton Hill is one of the best neighborhoods in Brooklyn. This location has the perfect mix of neighborhood quiet and city life hustle and bustle. Nestled in between Fort Greene and Bed Stuy, Clinton Hill gives you easy access to the best restaurants and bars in the borough.
5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Live like the Ramones &gt; The East Village is still cooler than you heard it was!
6 The borough of Queens offers plenty of outdoor recreation space and easy access to Manhattan. For peaceful scenery and outdoor recreation head to Forest Park (1.2 mi/1.9km away) where youâ€™ll find hiking trails and bridle paths for horseback riding, plus a public golf course and carousel for the kids. Along Rockaway Boulevard youâ€™ll find shopping like Marshallâ€™s for discount designer clothes and more and Modell's Sporting Goods for sportswear. La CabaÃ±a Peruana (9304 Liberty Avenue) serves up Peruvian cuisine, while Ozone Pizzeria (9615 Liberty Avenue) has classic NYC pizza and Italian dishes, and IHOP (9801 Liberty Ave) serves up their famous pancakes, all-day breakfast and diner fare. Try your luck at Resorts World Casino (.9mi/1.5km away).
                                                                                                                                 picture_url
1                               https://a0.muscache.com/pictures/hosting/Hosting-40824219/original/70ab046b-23cb-4c19-a553-a45a891bb3e9.jpeg
2                                                                  https://a0.muscache.com/pictures/1f093bbc-936c-4a8d-a386-c1e7f9bffe15.jpg
3                                                                  https://a0.muscache.com/pictures/01c4e91e-4012-4647-a264-c649794b2fc1.jpg
4                                                                  https://a0.muscache.com/pictures/9322d54a-6eb7-41ef-afb2-d67ae6bfe6dd.jpg
5 https://a0.muscache.com/pictures/hosting/Hosting-U3RheVN1cHBseUxpc3Rpbmc6NDA4Mzk0MTY%3D/original/2d03a7ee-3d4f-4c8a-b333-fa29696fef28.jpeg
6                                                                  https://a0.muscache.com/pictures/c5ca4ce9-8cb5-4a26-a118-28709b2c7ba0.jpg
    host_id                                    host_url host_name host_since
1 317540555 https://www.airbnb.com/users/show/317540555     Sevil 2019-12-14
2  68718914  https://www.airbnb.com/users/show/68718914  Patricio 2016-04-24
3 317770098 https://www.airbnb.com/users/show/317770098      Xuan 2019-12-15
4  17211451  https://www.airbnb.com/users/show/17211451    Jamila 2014-06-24
5   4765305   https://www.airbnb.com/users/show/4765305    Haffro 2013-01-19
6 295370107 https://www.airbnb.com/users/show/295370107 Dr. Tania 2019-09-16
            host_location
1                        
2                        
3 New York, United States
4            New York, NY
5            New York, NY
6 New York, United States
                                                                                                                                     host_about
1                                                                                                                                              
2                                                                                                                                              
3                                                                                                                                              
4                                                               Hello, Iâ€™m a global communications professional living and loving in Brooklyn. 
5                                                                                                                                              
6 Hi, Iâ€™m Dr. Tania Sheikh. Iâ€™m a physician at a local NYC hospital and Iâ€™m a mother of three kids. My husband is a former high school teacher.
  host_response_time host_response_rate host_acceptance_rate host_is_superhost
1 within a few hours               100%                  54%                 t
2                N/A                N/A                  N/A                 f
3                N/A                N/A                  N/A                 f
4                N/A                N/A                  N/A                 f
5       within a day                90%                  69%                 t
6 within a few hours                75%                 100%                 t
                                                                                          host_thumbnail_url
1 https://a0.muscache.com/im/pictures/user/771f9d60-559e-43f8-90b6-acaf31f81875.jpg?aki_policy=profile_small
2 https://a0.muscache.com/im/pictures/user/0b4f989e-4e0a-45ee-8a7f-6b3a8930e7ce.jpg?aki_policy=profile_small
3 https://a0.muscache.com/im/pictures/user/2c4b164f-513b-4c06-8500-10c8fe079528.jpg?aki_policy=profile_small
4     https://a0.muscache.com/im/users/17211451/profile_pic/1403641887/original.jpg?aki_policy=profile_small
5 https://a0.muscache.com/im/pictures/user/9565915b-93d8-4c72-96e4-d2538a8ff72c.jpg?aki_policy=profile_small
6 https://a0.muscache.com/im/pictures/user/5d78b12e-948e-4fc1-9663-e1d823dfef92.jpg?aki_policy=profile_small
                                                                                               host_picture_url
1 https://a0.muscache.com/im/pictures/user/771f9d60-559e-43f8-90b6-acaf31f81875.jpg?aki_policy=profile_x_medium
2 https://a0.muscache.com/im/pictures/user/0b4f989e-4e0a-45ee-8a7f-6b3a8930e7ce.jpg?aki_policy=profile_x_medium
3 https://a0.muscache.com/im/pictures/user/2c4b164f-513b-4c06-8500-10c8fe079528.jpg?aki_policy=profile_x_medium
4     https://a0.muscache.com/im/users/17211451/profile_pic/1403641887/original.jpg?aki_policy=profile_x_medium
5 https://a0.muscache.com/im/pictures/user/9565915b-93d8-4c72-96e4-d2538a8ff72c.jpg?aki_policy=profile_x_medium
6 https://a0.muscache.com/im/pictures/user/5d78b12e-948e-4fc1-9663-e1d823dfef92.jpg?aki_policy=profile_x_medium
  host_neighbourhood host_listings_count host_total_listings_count
1          Sunnyside                   3                         3
2                                      1                         1
3        Sunset Park                   1                         1
4       Clinton Hill                   1                         3
5      Alphabet City                   8                        16
6         Ozone Park                   2                         2
  host_verifications host_has_profile_pic host_identity_verified
1 ['email', 'phone']                    t                      t
2          ['phone']                    t                      t
3 ['email', 'phone']                    t                      t
4 ['email', 'phone']                    t                      t
5 ['email', 'phone']                    t                      t
6 ['email', 'phone']                    t                      t
            neighbourhood neighbourhood_cleansed neighbourhood_group_cleansed
1 Neighborhood highlights              Sunnyside                       Queens
2                                         Nolita                    Manhattan
3 Neighborhood highlights            Sunset Park                     Brooklyn
4 Neighborhood highlights           Clinton Hill                     Brooklyn
5 Neighborhood highlights           East Village                    Manhattan
6 Neighborhood highlights             Ozone Park                       Queens
  latitude longitude                      property_type       room_type
1 40.74698 -73.91763          Private room in townhouse    Private room
2 40.72314 -73.99323 Private room in serviced apartment    Private room
3 40.64607 -74.00552               Private room in home    Private room
4 40.68370 -73.96115                 Entire rental unit Entire home/apt
5 40.72147 -73.98270        Private room in rental unit    Private room
6 40.68230 -73.84545                        Entire home Entire home/apt
  accommodates bathrooms bathrooms_text bedrooms beds
1            1         1  1 shared bath        1    1
2            2        NA  1 shared bath        1   NA
3            1        NA  1 shared bath       NA   NA
4            1        NA         1 bath        1   NA
5            1         2 2 shared baths        1    1
6            6         1         1 bath        2    3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         amenities
1                                                                                    ["Extra pillows and blankets", "Dedicated workspace", "Laundromat nearby", "Clothing storage: wardrobe and dresser", "Iron", "Hot water kettle", "Drying rack for clothing", "Refrigerator", "Coffee maker", "Cleaning products", "Window AC unit", "Mosquito net", "Smoke alarm", "Luggage dropoff allowed", "Wifi", "Carbon monoxide alarm", "Oven", "Dining table", "Stove", "Heating", "Lock on bedroom door", "Hot water", "Hangers", "Free street parking", "Long term stays allowed", "Bed linens", "Dishes and silverware", "Garden view", "Kitchen"]
2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ["Hot water", "Air conditioning", "Wifi", "TV", "Dryer", "Washer", "Essentials", "Heating"]
3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ["Smoke alarm", "Kitchen", "Hair dryer", "Wifi", "Shampoo", "Private living room", "Heating", "Lock on bedroom door", "Private entrance"]
4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ["Hot water", "Smoke alarm", "Air conditioning", "Wifi", "Carbon monoxide alarm", "TV", "Free parking on premises", "Essentials", "Heating", "Kitchen"]
5 ["Dedicated workspace", "Microwave", "Elevator", "Dryer", "Iron", "Private living room", "Washer", "Essentials", "Hot water kettle", "Park view", "Self check-in", "Smoking allowed", "Hair dryer", "Outdoor dining area", "Central heating", "Refrigerator", "Coffee maker", "Free parking on premises", "Smoke alarm", "Breakfast", "Wifi", "Portable heater", "Shampoo", "Outdoor furniture", "Smart lock", "Fire extinguisher", "Shared gym in building", "Patio or balcony", "Hot water", "Hangers", "Air conditioning", "Exercise equipment", "City skyline view", "Radiant heating", "Dishes and silverware", "Kitchen", "First aid kit"]
6                                                                                                                                                                                                                                                                                                                                                                                                                          ["Hangers", "Smoke alarm", "Exterior security cameras on property", "Hair dryer", "Air conditioning", "Wifi", "Carbon monoxide alarm", "Shampoo", "TV", "Iron", "Essentials", "Heating", "Kitchen", "Private entrance"]
   price minimum_nights maximum_nights minimum_minimum_nights
1 $66.00             30            365                     30
2                    30           1125                     30
3                    30            180                     30
4                    90             90                     90
5 $76.00             30            900                     30
6 $97.00             30            365                     30
  maximum_minimum_nights minimum_maximum_nights maximum_maximum_nights
1                     30                    365                    365
2                     30                   1125                   1125
3                     30                    180                    180
4                     90                   1125                   1125
5                     30                    900                    900
6                     30                   1125                   1125
  minimum_nights_avg_ntm maximum_nights_avg_ntm calendar_updated
1                     30                    365               NA
2                     30                   1125               NA
3                     30                    180               NA
4                     90                   1125               NA
5                     30                    900               NA
6                     30                   1125               NA
  has_availability availability_30 availability_60 availability_90
1                t              16              46              76
2                t               0               0               0
3                                0               0               0
4                t               0               0               0
5                t              26              51              78
6                t              29              59              89
  availability_365 calendar_last_scraped number_of_reviews
1               77            2025-10-02                16
2                0            2025-10-02                 0
3                0            2025-10-02                 1
4                0            2025-10-02                 1
5              168            2025-10-02                20
6              364            2025-10-01                93
  number_of_reviews_ltm number_of_reviews_l30d availability_eoy
1                     2                      0               77
2                     0                      0                0
3                     0                      0                0
4                     0                      0                0
5                     0                      0               79
6                     1                      0               91
  number_of_reviews_ly estimated_occupancy_l365d estimated_revenue_l365d
1                    0                       120                    7920
2                    0                         0                      NA
3                    0                         0                      NA
4                    0                         0                      NA
5                    1                         0                       0
6                    0                        60                    5820
  first_review last_review review_scores_rating review_scores_accuracy
1   2019-12-25  2025-08-06                 4.81                   4.81
2                                            NA                     NA
3   2020-01-19  2020-01-19                 5.00                   5.00
4   2020-03-01  2020-03-01                 5.00                   5.00
5   2021-09-10  2024-09-01                 4.95                   4.80
6   2020-07-06  2025-01-25                 4.14                   4.26
  review_scores_cleanliness review_scores_checkin review_scores_communication
1                      4.88                  4.81                        4.88
2                        NA                    NA                          NA
3                      4.00                  5.00                        5.00
4                      5.00                  5.00                        5.00
5                      4.85                  5.00                        5.00
6                      4.09                  4.45                        4.06
  review_scores_location review_scores_value license instant_bookable
1                   4.94                4.69                        f
2                     NA                  NA                        t
3                   5.00                5.00                        f
4                   5.00                5.00                        t
5                   5.00                4.95                        f
6                   4.46                4.00                        f
  calculated_host_listings_count calculated_host_listings_count_entire_homes
1                              3                                           0
2                              1                                           0
3                              1                                           0
4                              1                                           1
5                              8                                           0
6                              2                                           2
  calculated_host_listings_count_private_rooms
1                                            3
2                                            1
3                                            1
4                                            0
5                                            8
6                                            0
  calculated_host_listings_count_shared_rooms reviews_per_month
1                                           0              0.23
2                                           0                NA
3                                           0              0.01
4                                           0              0.01
5                                           0              0.40
6                                           0              1.46</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>